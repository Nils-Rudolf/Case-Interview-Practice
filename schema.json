{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "additionalProperties": false,
  "required": ["version", "generatedAt", "cases"],
  "properties": {
    "version": { "const": "1.0" },
    "generatedAt": { "type": "string", "format": "date-time" },
    "cases": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": [
          "id", "title", "client", "language", "tags", "scenario",
          "instructions", "clarifying", "solution", "tts",
          "difficulty", "estimatedSolveMinutes"
        ],
        "properties": {
          "id": { "type": "string", "pattern": "^[a-z0-9]+(?:-[a-z0-9]+)*$" },
          "title": { "type": "string", "minLength": 3, "maxLength": 120 },
          "client": { "type": "string", "minLength": 3, "maxLength": 120 },
          "language": { "type": "string", "enum": ["de"] },
          "tags": {
            "type": "array",
            "items": { "type": "string", "minLength": 2 },
            "minItems": 1,
            "maxItems": 6
          },
          "scenario": { "type": "string", "minLength": 100 },
          "instructions": { "type": "string", "minLength": 10 },
          "clarifying": {
            "type": "object",
            "additionalProperties": false,
            "required": ["maxQuestions", "questions"],
            "properties": {
              "maxQuestions": { "type": "integer", "const": 2 },
              "questions": {
                "type": "array",
                "minItems": 4,
                "maxItems": 4,
                "items": {
                  "type": "object",
                  "additionalProperties": false,
                  "required": ["id", "question", "answer"],
                  "properties": {
                    "id": { "type": "string", "pattern": "^q[1-4]$" },
                    "question": { "type": "string", "minLength": 5 },
                    "answer": { "type": "string", "minLength": 2 }
                  }
                }
              }
            }
          },
          "solution": {
            "type": "object",
            "additionalProperties": false,
            "required": ["tree", "explanation", "pitfalls"],
            "properties": {
              "tree": {
                "type": "array",
                "minItems": 3,
                "maxItems": 6,
                "items": { "$ref": "#/definitions/treeNode" }
              },
              "explanation": { "type": "string", "minLength": 50 },
              "pitfalls": {
                "type": "array",
                "minItems": 3,
                "maxItems": 10,
                "items": { "type": "string", "minLength": 2 }
              }
            }
          },
          "tts": {
            "type": "object",
            "additionalProperties": false,
            "required": ["languageCode"],
            "properties": {
              "languageCode": { "type": "string", "enum": ["de-DE"] },
              "voice": { "type": "string" }
            }
          },
          "difficulty": { "type": "string", "enum": ["Easy", "Medium", "Hard"] },
          "estimatedSolveMinutes": { "type": "integer", "minimum": 5, "maximum": 60 }
        }
      }
    }
  },
  "definitions": {
    "treeNode": {
      "type": "object",
      "additionalProperties": false,
      "required": ["label"],
      "properties": {
        "label": { "type": "string", "minLength": 2 },
        "children": {
          "type": "array",
          "items": { "$ref": "#/definitions/treeNode" }
        }
      }
    }
  }
}